<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.omasystem.omas.Dao.SeatDao">

<!-- select all seats -->

<!-- SeatMapper.xml -->


    <resultMap id="seatResultMap" type="com.omasystem.omas.Model.SeatModel">
        <id property="seat_id" column="seat_id"/>
        <!-- Map seat_status column to SeatStatus enum -->
        <result property="seat_status" column="seat_status" javaType="com.omasystem.omas.Model.Enum.SeatStatus" />
        <result property="del_flag" column="del_flag"/>
        <result property="reg_id" column="reg_id"/>
        <result property="reg_date" column="reg_date"/>
        <result property="update_id" column="update_id"/>
        <result property="update_date" column="update_date"/>
    </resultMap>

    <select id="getAllSeats" resultMap="seatResultMap">
        SELECT seat_id, seat_status, del_flag, reg_id, reg_date, update_id, update_date
        FROM tbl_seat
        WHERE del_flag = 0
        ORDER BY seat_id ASC;
    </select>

    <select id="getSeatStatus" resultMap="seatResultMap">
        SELECT seat_id, seat_status, del_flag, reg_id, reg_date, update_id, update_date
         FROM tbl_seat
        WHERE seat_status = #{seat_status}

    </select>

    <!-- <select id="getAllOccupiedSeats" resultMap="seatResultMap">
        SELECT seat_id, seat_status, del_flag, reg_id, reg_date, update_id, update_date
         FROM tbl_seat
        WHERE seat_status = #{seat_status}

    </select> -->

    <!--Get total seats by project-->
    <select id="getTotalSeatsByProject" resultMap="seatsByProjectResultMap">
        SELECT
            COUNT(reservation.seat_id) AS totalSeatsReserved
        FROM
            tbl_reservation AS reservation
        INNER JOIN
            tbl_project_mst AS proj ON reservation.proj_id = proj.proj_id
        WHERE
            proj.proj_id = #{projId}
        GROUP BY
            proj.proj_id
    </select>
    <resultMap id="seatsByProjectResultMap" type="Integer">
        <result property="totalSeatsReserved" column="totalSeatsReserved"/>
    </resultMap>



</mapper>